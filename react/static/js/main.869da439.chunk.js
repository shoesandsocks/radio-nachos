(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{11:function(e,t,a){e.exports=a(17)},16:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(6),c=a.n(l),i=(a(16),a(1)),o=a(2),s=a(7),m=a(8),u=a(9),p=a(10),d=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={error:null,errorInfo:null},n}return Object(m.a)(a,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function(){return this.state.errorInfo?r.a.createElement("div",null,r.a.createElement("h2",null,"Something went wrong."),r.a.createElement("details",{style:{whiteSpace:"pre-wrap"}},this.state.error&&this.state.error.toString(),r.a.createElement("br",null),this.state.errorInfo.componentStack),r.a.createElement("p",null,'Try logging in again. If there\'s a "blank" radio-nachos playlist in your Spotify, delete it.'),r.a.createElement("a",{href:"/"},"Go back.")):this.props.children}}]),a}(r.a.Component);var y=function(){var e=Object(n.useState)(20),t=Object(o.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)([["",100,""]]),s=Object(o.a)(c,2),m=s[0],u=s[1],p=Object(n.useState)({playlists:[],compositions:[],recentPlaylists:[]}),y=Object(o.a)(p,2),h=y[0],f=y[1],g=Object(n.useState)(""),v=Object(o.a)(g,2),E=v[0],b=v[1],w=Object(n.useState)(!1),k=Object(o.a)(w,2),N=k[0],O=k[1];Object(n.useEffect)((function(){fetch("/getPrev").then((function(e){return e.json()})).then((function(e){return f(e)})).catch((function(e){window.location.replace("/")}))}),[]);var S=function(e){return O(!1),setTimeout((function(){return b("")}),7e3),b(e)},j=function(e){var t=e.target.value,a=e.target.dataset.name;if(t.match(/^spotify:playlist:[a-zA-Z0-9]{22}$/)){var n=m.concat([[t,0,a]]);return u(n)}return S("that didn't work right.")},I=function(e){var t=e.target,a=t.name,n=t.value;if("tracks"===a&&l(n),a.match(/^playlist/)){var r=a.replace("playlist","").toString(),c=Object(i.a)(m);return c[r][0]=n,void(n.match(/^spotify:playlist:[a-zA-Z0-9]{22}$/)?function(e,t,a,n,r){fetch("/playlistlookup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({str:e})}).then((function(e){return e.json()})).then((function(e){var l=e.error,c=e.name;r(l);var o=Object(i.a)(a);return o[t][2]=c||"",n(o)})).catch((function(e){return r("Lookup failed. Are you logged in?")}))}(n,r,m,u,S):(c[r][2]="",u(c)))}if(a.match(/^percent/)){var o=a.replace("percent","").toString(),s=Object(i.a)(m);s[o][1]=n,u(s)}},C=function(e){var t=Object(i.a)(m);t.push(["",0]),u(t)},T=function(e){var t=m.filter((function(t,a){return a!==Number(e.target.value)}));u(t)},D=function(e){return e.reduce((function(e,t){return e+Number(t[1])}),0)};return r.a.createElement(d,null,r.a.createElement("div",{className:"App"},r.a.createElement("h1",null,"radio nachos"),r.a.createElement("div",{className:"sidebar"},r.a.createElement("h2",null,"Your playlists"),r.a.createElement("ul",{id:"previous"},!h.playlists.length&&r.a.createElement("li",null,r.a.createElement("p",{id:"nope"},"you have no previous playlists")),function(e,t,a,n){var l=function(e){var n=JSON.parse(e.target.dataset.composition),r=e.target.dataset.tracks,l=n.map((function(e){return[e.playlistId,e.percentage,e.playlistName]}));t(l),a(r),window.scrollTo({top:0,left:0,behavior:"smooth"})},c=function(e){var t=e.target.id.replace("playlist-","");fetch("/deletePlaylist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToDelete:t})}).then((function(e){return e.json()})).then((function(e){return console.log(e),e.error?n(e.error):window.location.reload()})).catch((function(){return window.location.replace("/")}))};try{var i=e.playlists,o=e.compositions;return i.map((function(e){var t=e.id,a=+e.name.split("-")[2],n=new Date(a),i="https://www.porknachos.com/files/naviavi.jpg";e.images&&e.images.length>1&&(i=e.images[1].url);var s=o.filter((function(e){return e.timestamp===a.toString()}))[0],m="".concat(n.toLocaleTimeString(),", ").concat(n.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"short",day:"numeric"}));if(void 0!==s){var u=s.compositionData,p=s.numberOfTracks;return!p||p<1?r.a.createElement("li",{key:t,className:"playlist-entry-wrap"},r.a.createElement("a",{href:"/radio?timestamp=".concat(a,"&listId=").concat(t)},r.a.createElement("img",{src:i,alt:"playlist graphic from spotify"}),r.a.createElement("p",null,"An empty playlist")),r.a.createElement("div",{className:"playlist-buttons"},r.a.createElement("div",null,"\xa0"),r.a.createElement("button",{onClick:c,className:"delete-playlist-btn",id:"playlist-".concat(t)},"delete this playlist")),"`"):r.a.createElement("li",{key:t,className:"playlist-entry-wrap"},r.a.createElement("a",{href:"/radio?timestamp=".concat(a,"&listId=").concat(t)},r.a.createElement("img",{src:i,alt:"playlist graphic from spotify"}),r.a.createElement("p",null,m," - ",p," songs")),u.map((function(e){return r.a.createElement("p",{key:e.playlistId,className:"one-playlist-line"},e.playlistName," (",e.playlistId,")",r.a.createElement("span",null,e.percentage,"%"))})),r.a.createElement("div",{className:"playlist-buttons"},r.a.createElement("button",{className:"make-another-btn","data-composition":JSON.stringify(u),"data-tracks":p,onClick:l},"Set up a similar playlist"),r.a.createElement("button",{onClick:c,className:"delete-playlist-btn",id:"playlist-".concat(t)},"delete this playlist")),"`")}return r.a.createElement("li",{className:"playlist-entry-wrap"},r.a.createElement("a",{href:"/radio?timestamp=".concat(a,"&listId=").concat(t)},r.a.createElement("img",{src:"".concat(e.images[1].url),alt:"playlist graphic from spotify"}),r.a.createElement("p",null,"$",m)))}))}catch(s){return console.log(s,"error mapping playlists"),r.a.createElement("p",null,"Something failed catastrophically. If you have a blank radio-nachos playlist in your Spotify account, delete it and reload. Otherwise,",r.a.createElement("a",{href:"/"},"try logging in again.")," You might need to message me.")}}(h,u,l,S))),r.a.createElement("div",{className:"primary"},r.a.createElement("h2",null,"playlist maker"),r.a.createElement("form",{id:"creator-form"},r.a.createElement("fieldset",{id:"fieldset"},r.a.createElement("div",{id:"all-entries"},m.map((function(e,t){return function(e,t,a,n,l){var c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return r.a.createElement("div",{key:e},r.a.createElement("div",{className:"above-entry-wrap"},r.a.createElement("p",{className:"label-spacer"}),r.a.createElement("p",{className:"playlist-name-lookup",id:"playlist1-name-lookup"},t[2])),r.a.createElement("div",{className:"one-entry-wrap"},r.a.createElement("label",{htmlFor:"playlist".concat(e)},"playlist ID"),r.a.createElement("input",{type:"text",name:"playlist".concat(e),id:"playlist".concat(e),className:"playlist-id","data-lpignore":"true",required:!0,placeholder:"spotify:playlist:37i9dQZF1DZ06evO05tE88",value:t[0],onChange:a}),r.a.createElement("input",{type:"number",className:"percentage",id:"percent".concat(e),name:"percent".concat(e),value:t[1],min:"1",max:"100",step:"1",onChange:a}),r.a.createElement("label",{htmlFor:"percent".concat(e)},"%"),r.a.createElement("button",{type:"button",className:"add-entry-button ".concat(c?"":"visually-hidden"),id:"add-entry-button-".concat(e),value:e,onClick:n},"add more"),!i&&r.a.createElement("button",{type:"button",className:"remove-entry-button",id:"remove-entry-button-".concat(e),value:e,onClick:l},"remove this")))}(t,e,I,C,T,t===m.length-1,1===m.length)}))),r.a.createElement("p",{id:"total"},D(m)),r.a.createElement("p",{id:"currentVal"},a),r.a.createElement("label",{htmlFor:"tracks"},"how many tracks? (10 - 99)"),r.a.createElement("br",null),r.a.createElement("input",{type:"range",id:"tracks-input",name:"tracks",value:a,min:"10",max:"99",step:"1",onChange:I}),r.a.createElement("br",null),r.a.createElement("div",{id:"count-and-button"},r.a.createElement("span",{id:"global-error"},E),r.a.createElement("button",{id:"submit-btn",type:"submit",onClick:function(e){return e.preventDefault(),O(!0),100!==D(m)?S("C'mon. That's not 100%, Brad."):m.filter((function(e){return 3!==e.length})).length>0?S("You missed a playlist, there."):m.map((function(e){return e[2]})).includes("")?S("Missing a valid playlist there?"):void fetch("/make",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({arrayOfArrays:m,numberOfTracks:a})}).then((function(e){return e.json()})).then((function(e){var t=e.listId,a=e.timestamp,n=e.error;if(n)return S(n);var r=new URL(window.location.href);return window.location.href="".concat(r.origin,"/radio?listId=").concat(t,"&timestamp=").concat(a)})).catch((function(e){return console.log(e),S("Serious failure; sorry.")}))},disabled:N},N?r.a.createElement("span",null,r.a.createElement("svg",{id:"spinner",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"#ffffff"},r.a.createElement("path",{d:"M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z"}))):"create playlist")))),r.a.createElement("h2",null,"Recently used playlists"),r.a.createElement("ul",{id:"recent-list"},h.recentPlaylists.map((function(e){return r.a.createElement("div",{className:"recent-wrap"},r.a.createElement("div",{className:"recent-left-col"},r.a.createElement("p",{className:"recent-name"},r.a.createElement("a",{href:e.playlistId},e.playlistName)),r.a.createElement("p",{className:"recent-id"},e.playlistId)),r.a.createElement("div",{className:"recent-right-col"},r.a.createElement("button",{className:"add-recent-playlist",value:e.playlistId,"data-name":e.playlistName,onClick:j},"add to form")))}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[11,1,2]]]);
//# sourceMappingURL=main.869da439.chunk.js.map