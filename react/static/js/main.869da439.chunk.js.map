{"version":3,"sources":["helpers/ErrorBoundary.js","App.js","helpers/handleLookup.js","helpers/makePrevPlaylists.js","helpers/renderFormLine.js","serviceWorker.js","index.js"],"names":["ErrorBoundary","props","state","error","errorInfo","this","setState","style","whiteSpace","toString","componentStack","href","children","React","Component","App","useState","numberOfTracks","setNumberOfTracks","submission","setSubmission","playlists","compositions","recentPlaylists","prevs","setPrevs","globalError","setGlobalError","isCreating","setIsCreating","useEffect","fetch","then","x","json","catch","e","window","location","replace","displayError","msg","setTimeout","addRecentToForm","playlistId","target","value","playlistName","dataset","name","match","newSub","concat","handleInputChange","num","str","method","headers","body","JSON","stringify","r","handleLookup","addFormLine","push","removeFormLine","filter","_","index","Number","calcTotal","reduce","acc","curr","className","id","length","populateForm","composition","parse","tracks","map","comp","percentage","scrollTo","top","left","behavior","deletePlaylist","idToDelete","console","log","reload","pL","timestring","split","timestamp","Date","image","images","url","displayDate","toLocaleTimeString","toLocaleDateString","weekday","year","month","day","undefined","compositionData","key","src","alt","onClick","compo","data-composition","data-tracks","er","makePrevPlaylists","array","isLast","isOnly","htmlFor","type","data-lpignore","required","placeholder","onChange","min","max","step","renderFormLine","preventDefault","s","includes","arrayOfArrays","listId","URL","origin","disabled","xmlns","width","height","viewBox","fill","d","entry","data-name","Boolean","hostname","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","message"],"mappings":"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","file":"static/js/main.869da439.chunk.js","sourcesContent":["import React from \"react\";\n\n// lifted straight from Dan A.\n// https://codepen.io/gaearon/pen/wqvxGa?editors=0010\n\nclass ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { error: null, errorInfo: null };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    // Catch errors in any components below and re-render with error message\n    this.setState({\n      error: error,\n      errorInfo: errorInfo,\n    });\n    // You can also log error messages to an error reporting service here\n  }\n\n  render() {\n    if (this.state.errorInfo) {\n      // Error path\n      return (\n        <div>\n          <h2>Something went wrong.</h2>\n          <details style={{ whiteSpace: \"pre-wrap\" }}>\n            {this.state.error && this.state.error.toString()}\n            <br />\n            {this.state.errorInfo.componentStack}\n          </details>\n          <p>\n            Try logging in again. If there's a \"blank\" radio-nachos playlist in\n            your Spotify, delete it.\n          </p>\n          <a href=\"/\">Go back.</a>\n        </div>\n      );\n    }\n    // Normally, just render children\n    return this.props.children;\n  }\n}\n\nexport default ErrorBoundary;\n","import React, { useEffect, useState } from \"react\";\n\nimport renderFormLine from \"./helpers/renderFormLine\";\nimport makePrevPlaylists from \"./helpers/makePrevPlaylists\";\nimport handleLookup from \"./helpers/handleLookup\";\nimport ErrorBoundary from \"./helpers/ErrorBoundary\";\n\nconst spinner = () => (\n  <svg\n    id=\"spinner\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"#ffffff\"\n  >\n    <path d=\"M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z\" />\n  </svg>\n);\n\nfunction App() {\n  const [numberOfTracks, setNumberOfTracks] = useState(20);\n  const [submission, setSubmission] = useState([[\"\", 100, \"\"]]); // id, %age, name (generated by func)\n  const [prevs, setPrevs] = useState({\n    playlists: [],\n    compositions: [],\n    recentPlaylists: [],\n  });\n  const [globalError, setGlobalError] = useState(\"\");\n  const [isCreating, setIsCreating] = useState(false);\n\n  useEffect(() => {\n    fetch(\"/getPrev\")\n      .then((x) => x.json())\n      .then((json) => setPrevs(json))\n      .catch((e) => {\n        window.location.replace(\"/\");\n      });\n  }, []);\n\n  const displayError = (msg) => {\n    setIsCreating(false);\n    setTimeout(() => setGlobalError(\"\"), 7000);\n    return setGlobalError(msg);\n  };\n\n  const addRecentToForm = (e) => {\n    const playlistId = e.target.value;\n    const playlistName = e.target.dataset.name;\n    if (playlistId.match(/^spotify:playlist:[a-zA-Z0-9]{22}$/)) {\n      const newSub = submission.concat([[playlistId, 0, playlistName]]);\n      return setSubmission(newSub);\n    }\n    return displayError(\"that didn't work right.\");\n  };\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    if (name === \"tracks\") setNumberOfTracks(value);\n    if (name.match(/^playlist/)) {\n      const num = name.replace(\"playlist\", \"\").toString();\n      const newSub = [...submission];\n      newSub[num][0] = value;\n      // setSubmission(newSub);\n      if (value.match(/^spotify:playlist:[a-zA-Z0-9]{22}$/)) {\n        handleLookup(value, num, submission, setSubmission, displayError);\n      } else {\n        newSub[num][2] = \"\";\n        setSubmission(newSub);\n      }\n      return;\n    }\n    if (name.match(/^percent/)) {\n      const num = name.replace(\"percent\", \"\").toString();\n      const newSub = [...submission];\n      newSub[num][1] = value;\n      setSubmission(newSub);\n    }\n  };\n  const addFormLine = (e) => {\n    const newSub = [...submission];\n    newSub.push([\"\", 0]);\n    setSubmission(newSub);\n  };\n  const removeFormLine = (e) => {\n    const newSub = submission.filter(\n      (_, index) => index !== Number(e.target.value)\n    );\n    setSubmission(newSub);\n  };\n\n  const calcTotal = (submission) =>\n    submission.reduce((acc, curr) => acc + Number(curr[1]), 0);\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setIsCreating(true);\n    if (calcTotal(submission) !== 100) {\n      return displayError(\"C'mon. That's not 100%, Brad.\");\n    }\n    const sizes = submission.filter((s) => s.length !== 3);\n    if (sizes.length > 0) return displayError(\"You missed a playlist, there.\");\n    const allPlaylistNames = submission.map((s) => s[2]);\n    if (allPlaylistNames.includes(\"\"))\n      return displayError(\"Missing a valid playlist there?\");\n\n    fetch(\"/make\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        arrayOfArrays: submission,\n        numberOfTracks,\n      }),\n    })\n      .then((r) => r.json())\n      .then((json) => {\n        const { listId, timestamp, error } = json;\n        if (error) {\n          return displayError(error);\n        }\n        const url = new URL(window.location.href);\n        return (window.location.href = `${url.origin}/radio?listId=${listId}&timestamp=${timestamp}`);\n      })\n      .catch((e) => {\n        console.log(e);\n        return displayError(\"Serious failure; sorry.\");\n      });\n  };\n\n  return (\n    <ErrorBoundary>\n      <div className=\"App\">\n        <h1>radio nachos</h1>\n        <div className=\"sidebar\">\n          <h2>Your playlists</h2>\n          <ul id=\"previous\">\n            {!prevs.playlists.length && (\n              <li>\n                <p id=\"nope\">you have no previous playlists</p>\n              </li>\n            )}\n            {makePrevPlaylists(\n              prevs,\n              setSubmission,\n              setNumberOfTracks,\n              displayError\n            )}\n          </ul>\n        </div>\n        <div className=\"primary\">\n          <h2>playlist maker</h2>\n          <form id=\"creator-form\">\n            <fieldset id=\"fieldset\">\n              <div id=\"all-entries\">\n                {submission.map((array, index) =>\n                  renderFormLine(\n                    index,\n                    array,\n                    handleInputChange,\n                    addFormLine,\n                    removeFormLine,\n                    index === submission.length - 1,\n                    submission.length === 1\n                  )\n                )}\n              </div>\n              <p id=\"total\">{calcTotal(submission)}</p>\n              <p id=\"currentVal\">{numberOfTracks}</p>\n\n              <label htmlFor=\"tracks\">how many tracks? (10 - 99)</label>\n              <br />\n              <input\n                type=\"range\"\n                id=\"tracks-input\"\n                name=\"tracks\"\n                value={numberOfTracks}\n                min=\"10\"\n                max=\"99\"\n                step=\"1\"\n                onChange={handleInputChange}\n              />\n              <br />\n              <div id=\"count-and-button\">\n                <span id=\"global-error\">{globalError}</span>\n                <button\n                  id=\"submit-btn\"\n                  type=\"submit\"\n                  onClick={handleSubmit}\n                  disabled={isCreating}\n                >\n                  {isCreating ? <span>{spinner()}</span> : \"create playlist\"}\n                </button>\n              </div>\n            </fieldset>\n          </form>\n          <h2>Recently used playlists</h2>\n          <ul id=\"recent-list\">\n            {prevs.recentPlaylists.map((entry) => (\n              <div className=\"recent-wrap\">\n                <div className=\"recent-left-col\">\n                  <p className=\"recent-name\">\n                    <a href={entry.playlistId}>{entry.playlistName}</a>\n                  </p>\n                  <p className=\"recent-id\">{entry.playlistId}</p>\n                </div>\n                <div className=\"recent-right-col\">\n                  <button\n                    className=\"add-recent-playlist\"\n                    value={entry.playlistId}\n                    data-name={entry.playlistName}\n                    onClick={addRecentToForm}\n                  >\n                    add to form\n                  </button>\n                </div>\n              </div>\n            ))}\n          </ul>\n        </div>\n      </div>\n    </ErrorBoundary>\n  );\n}\n\nexport default App;\n","export default (str, num, submission, setSubmission, displayError) => {\n  fetch(\"/playlistlookup\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({ str }),\n  })\n    .then((r) => r.json())\n    .then(({ error, name }) => {\n      displayError(error);\n      const newSub = [...submission];\n      newSub[num][2] = name ? name : \"\";\n      return setSubmission(newSub);\n    })\n    .catch((e) => displayError(\"Lookup failed. Are you logged in?\"));\n};\n","import React from \"react\";\n\nexport default (prevs, setSubmission, setNumberOfTracks, displayError) => {\n  const populateForm = (e) => {\n    const composition = JSON.parse(e.target.dataset.composition);\n    const { tracks } = e.target.dataset;\n    const newSub = composition.map((comp) => [\n      comp.playlistId,\n      comp.percentage,\n      comp.playlistName,\n    ]);\n    setSubmission(newSub);\n    setNumberOfTracks(tracks);\n    window.scrollTo({\n      top: 0,\n      left: 0,\n      behavior: \"smooth\",\n    });\n  };\n  const deletePlaylist = (e) => {\n    const { id } = e.target;\n    const idToDelete = id.replace(\"playlist-\", \"\");\n    fetch(\"/deletePlaylist\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({ idToDelete }),\n    })\n      .then((r) => r.json())\n      .then((json) => {\n        console.log(json);\n        if (json.error) {\n          return displayError(json.error);\n        }\n        return window.location.reload();\n      })\n      .catch(() => window.location.replace(\"/\"));\n  };\n\n  try {\n    const { playlists, compositions } = prevs;\n    return playlists.map((pL) => {\n      const { id } = pL;\n      const timestring = +pL.name.split(\"-\")[2]; // the part after radio-nachos-\n      const timestamp = new Date(timestring);\n      let image = \"https://www.porknachos.com/files/naviavi.jpg\";\n      if (pL.images && pL.images.length > 1) {\n        image = pL.images[1].url;\n      }\n\n      const composition = compositions.filter(\n        (comp) => comp.timestamp === timestring.toString()\n      )[0];\n      const options = {\n        weekday: \"long\",\n        year: \"numeric\",\n        month: \"short\",\n        day: \"numeric\",\n      };\n      const displayDate = `${timestamp.toLocaleTimeString()}, ${timestamp.toLocaleDateString(\n        \"en-US\",\n        options\n      )}`;\n      if (composition !== undefined) {\n        const { compositionData, numberOfTracks } = composition;\n        if (!numberOfTracks || numberOfTracks < 1) {\n          return (\n            <li key={id} className=\"playlist-entry-wrap\">\n              <a href={`/radio?timestamp=${timestring}&listId=${id}`}>\n                <img src={image} alt=\"playlist graphic from spotify\" />\n                <p>An empty playlist</p>\n              </a>\n              <div className=\"playlist-buttons\">\n                <div>&nbsp;</div>\n                <button\n                  onClick={deletePlaylist}\n                  className=\"delete-playlist-btn\"\n                  id={`playlist-${id}`}\n                >\n                  delete this playlist\n                </button>\n              </div>\n              `\n            </li>\n          );\n        }\n        return (\n          <li key={id} className=\"playlist-entry-wrap\">\n            <a href={`/radio?timestamp=${timestring}&listId=${id}`}>\n              <img src={image} alt=\"playlist graphic from spotify\" />\n              <p>\n                {displayDate} - {numberOfTracks} songs\n              </p>\n            </a>\n            {compositionData.map((compo) => (\n              <p key={compo.playlistId} className=\"one-playlist-line\">\n                {compo.playlistName} ({compo.playlistId})\n                <span>{compo.percentage}%</span>\n              </p>\n            ))}\n            <div className=\"playlist-buttons\">\n              <button\n                className=\"make-another-btn\"\n                data-composition={JSON.stringify(compositionData)}\n                data-tracks={numberOfTracks}\n                onClick={populateForm}\n              >\n                Set up a similar playlist\n              </button>\n              <button\n                onClick={deletePlaylist}\n                className=\"delete-playlist-btn\"\n                id={`playlist-${id}`}\n              >\n                delete this playlist\n              </button>\n            </div>\n            `\n          </li>\n        );\n      } else {\n        return (\n          <li className=\"playlist-entry-wrap\">\n            <a href={`/radio?timestamp=${timestring}&listId=${id}`}>\n              <img\n                src={`${pL.images[1].url}`}\n                alt=\"playlist graphic from spotify\"\n              />\n              <p>${displayDate}</p>\n            </a>\n          </li>\n        );\n      }\n    });\n  } catch (er) {\n    console.log(er, \"error mapping playlists\");\n    return (\n      <p>\n        Something failed catastrophically. If you have a blank radio-nachos\n        playlist in your Spotify account, delete it and reload. Otherwise,\n        <a href=\"/\">try logging in again.</a> You might need to message me.\n      </p>\n    );\n  }\n};\n","import React from \"react\";\n\nexport default function (\n  num,\n  array,\n  handleInputChange,\n  addFormLine,\n  removeFormLine,\n  isLast = false,\n  isOnly = true\n) {\n  // console.log(num, array);\n  return (\n    <div key={num}>\n      <div className=\"above-entry-wrap\">\n        <p className=\"label-spacer\"></p>\n        <p className=\"playlist-name-lookup\" id=\"playlist1-name-lookup\">\n          {array[2]}\n        </p>\n      </div>\n      <div className=\"one-entry-wrap\">\n        <label htmlFor={`playlist${num}`}>playlist ID</label>\n        <input\n          type=\"text\"\n          name={`playlist${num}`}\n          id={`playlist${num}`}\n          className=\"playlist-id\"\n          data-lpignore=\"true\"\n          required\n          placeholder=\"spotify:playlist:37i9dQZF1DZ06evO05tE88\"\n          value={array[0]}\n          onChange={handleInputChange}\n        />\n        <input\n          type=\"number\"\n          className=\"percentage\"\n          id={`percent${num}`}\n          name={`percent${num}`}\n          value={array[1]}\n          min=\"1\"\n          max=\"100\"\n          step=\"1\"\n          onChange={handleInputChange}\n        />\n        <label htmlFor={`percent${num}`}>%</label>\n        <button\n          type=\"button\"\n          className={`add-entry-button ${!isLast ? \"visually-hidden\" : \"\"}`}\n          id={`add-entry-button-${num}`}\n          value={num}\n          onClick={addFormLine}\n        >\n          add more\n        </button>\n\n        {!isOnly && (\n          <button\n            type=\"button\"\n            className=\"remove-entry-button\"\n            id={`remove-entry-button-${num}`}\n            value={num}\n            onClick={removeFormLine}\n          >\n            remove this\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}